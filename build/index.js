(()=>{"use strict";const e=window.wp.blocks,t=window.React,o=window.wp.i18n,n=window.wp.blockEditor,r=window.wp.coreData,l=window.wp.data,s=window.wp.element,a=window.wp.components,u=JSON.parse('{"UU":"wielgosz-info/wi-query-tax-filter"}');(0,e.registerBlockType)(u.UU,{edit:function({context:e,attributes:u,setAttributes:c}){const{query:{postType:i,taxQuery:m},queryId:p}=e,{taxonomy:w,number:y}=u,d=(0,l.useSelect)((e=>{const{getTaxonomies:t}=e(r.store);return t({type:i,per_page:-1})}),[i]),g=(0,s.useMemo)((()=>d?m?d.filter((e=>!Object.entries(m).some((([t,o])=>!(e.slug!==t||!o||!o.length))))):d:[]),[d,m]),x=(0,s.useMemo)((()=>g?g.map((e=>({label:e.name,value:e.slug}))):[]),[g]),b=(0,l.useSelect)((e=>{const{getEntityRecords:t}=e(r.store);return t("taxonomy",w,{per_page:y,orderby:"count",order:"desc"})}),[w,y]),f=(0,s.useMemo)((()=>`query-${p}-page=1`),[p]),E=(0,s.useMemo)((()=>[["core/buttons",{justifyContent:"flex-start",verticalAlignment:"center"},[["core/button",{text:(0,o.__)("All","wi-query-tax-filter"),url:`?${f}`}],...b?b.map((e=>["core/button",{text:e.name,url:`?${f}&qt_taxonomy=${w}&qt_term=${e.slug}`}])):[]]]]),[b,w]),_=(0,n.useInnerBlocksProps)((0,n.useBlockProps)(),{template:E,templateLock:"all"});return(0,s.useEffect)((()=>{!w&&g&&g.length>0&&c({taxonomy:g[0].slug})}),[w,g]),(0,t.createElement)(t.Fragment,null,(0,t.createElement)(n.InspectorControls,null,(0,t.createElement)(a.PanelBody,null,(0,t.createElement)(a.SelectControl,{label:(0,o.__)("Taxonomy","wi-query-tax-filter"),value:w,options:x,onChange:e=>c({taxonomy:e})}),(0,t.createElement)(a.RangeControl,{label:(0,o.__)("Number of terms","wi-query-tax-filter"),value:y,onChange:e=>c({number:e}),min:1,max:20}))),(0,t.createElement)("div",{..._}))},save:function(){const e=n.useBlockProps.save(),o=n.useInnerBlocksProps.save(e);return(0,t.createElement)("div",{...o})}})})();